\doxysection{ciphers\+::elliptic\+\_\+curve\+\_\+key\+\_\+exchange Namespace Reference}
\hypertarget{namespaceciphers_1_1elliptic__curve__key__exchange}{}\label{namespaceciphers_1_1elliptic__curve__key__exchange}\index{ciphers::elliptic\_curve\_key\_exchange@{ciphers::elliptic\_curve\_key\_exchange}}


namespace \doxylink{namespaceciphers_1_1elliptic__curve__key__exchange}{elliptic\+\_\+curve\+\_\+key\+\_\+exchange}  


\doxysubsubsection*{Classes}
\begin{DoxyCompactItemize}
\item 
struct \mbox{\hyperlink{structciphers_1_1elliptic__curve__key__exchange_1_1_point}{Point}}
\begin{DoxyCompactList}\small\item\em Definition of struct \doxylink{structciphers_1_1elliptic__curve__key__exchange_1_1_point}{Point}. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsubsection*{Typedefs}
\begin{DoxyCompactItemize}
\item 
typedef struct ciphers\+::elliptic\+\_\+curve\+\_\+key\+\_\+exchange\+::\+Point \mbox{\hyperlink{namespaceciphers_1_1elliptic__curve__key__exchange_af0a6e3521629c25c2b5d620f26429830}{Point}}
\begin{DoxyCompactList}\small\item\em Definition of struct \doxylink{structciphers_1_1elliptic__curve__key__exchange_1_1_point}{Point}. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{classuint256__t}{uint256\+\_\+t}} \mbox{\hyperlink{namespaceciphers_1_1elliptic__curve__key__exchange_ac00616a4e40d3cd5cfb4da87d9ff9af0}{exp}} (\mbox{\hyperlink{classuint256__t}{uint256\+\_\+t}} number, \mbox{\hyperlink{classuint256__t}{uint256\+\_\+t}} \mbox{\hyperlink{power__for__huge__numbers_8cpp_ae249a2af508aa94266023ce8aa81426f}{power}}, const \mbox{\hyperlink{classuint256__t}{uint256\+\_\+t}} \&mod)
\begin{DoxyCompactList}\small\item\em This function calculates number raised to exponent power under modulo mod using \href{https://github.com/TheAlgorithms/C-Plus-Plus/blob/master/math/modular_exponentiation.cpp}{\texttt{ Modular Exponentiation}}. \end{DoxyCompactList}\item 
\mbox{\hyperlink{structciphers_1_1elliptic__curve__key__exchange_1_1_point}{Point}} \mbox{\hyperlink{namespaceciphers_1_1elliptic__curve__key__exchange_acc5fe9c2032fb7582c38a20d1fa69bcf}{addition}} (\mbox{\hyperlink{structciphers_1_1elliptic__curve__key__exchange_1_1_point}{Point}} a, \mbox{\hyperlink{structciphers_1_1elliptic__curve__key__exchange_1_1_point}{Point}} b, const \mbox{\hyperlink{classuint256__t}{uint256\+\_\+t}} \&curve\+\_\+a\+\_\+coeff, \mbox{\hyperlink{classuint256__t}{uint256\+\_\+t}} mod)
\begin{DoxyCompactList}\small\item\em Addition of points. \end{DoxyCompactList}\item 
\mbox{\hyperlink{structciphers_1_1elliptic__curve__key__exchange_1_1_point}{Point}} \mbox{\hyperlink{namespaceciphers_1_1elliptic__curve__key__exchange_a17f3d667241b88115a95282cdd719cb2}{multiply}} (const \mbox{\hyperlink{structciphers_1_1elliptic__curve__key__exchange_1_1_point}{Point}} \&a, const \mbox{\hyperlink{classuint256__t}{uint256\+\_\+t}} \&curve\+\_\+a\+\_\+coeff, \mbox{\hyperlink{classuint256__t}{uint256\+\_\+t}} p, const \mbox{\hyperlink{classuint256__t}{uint256\+\_\+t}} \&mod)
\begin{DoxyCompactList}\small\item\em multiply \doxylink{structciphers_1_1elliptic__curve__key__exchange_1_1_point}{Point} and integer \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
namespace \doxylink{namespaceciphers_1_1elliptic__curve__key__exchange}{elliptic\+\_\+curve\+\_\+key\+\_\+exchange} 

Demonstration of \href{https://cryptobook.nakov.com/asymmetric-key-ciphers/ecdh-key-exchange}{\texttt{ Elliptic Curve Diffie-\/\+Hellman}} key exchange. 

\doxysubsection{Typedef Documentation}
\Hypertarget{namespaceciphers_1_1elliptic__curve__key__exchange_af0a6e3521629c25c2b5d620f26429830}\index{ciphers::elliptic\_curve\_key\_exchange@{ciphers::elliptic\_curve\_key\_exchange}!Point@{Point}}
\index{Point@{Point}!ciphers::elliptic\_curve\_key\_exchange@{ciphers::elliptic\_curve\_key\_exchange}}
\doxysubsubsection{\texorpdfstring{Point}{Point}}
{\footnotesize\ttfamily \label{namespaceciphers_1_1elliptic__curve__key__exchange_af0a6e3521629c25c2b5d620f26429830} 
typedef struct ciphers\+::elliptic\+\_\+curve\+\_\+key\+\_\+exchange\+::\+Point ciphers\+::elliptic\+\_\+curve\+\_\+key\+\_\+exchange\+::\+Point}



Definition of struct \doxylink{structciphers_1_1elliptic__curve__key__exchange_1_1_point}{Point}. 

Definition of \doxylink{structciphers_1_1elliptic__curve__key__exchange_1_1_point}{Point} in the curve. 

\doxysubsection{Function Documentation}
\Hypertarget{namespaceciphers_1_1elliptic__curve__key__exchange_acc5fe9c2032fb7582c38a20d1fa69bcf}\index{ciphers::elliptic\_curve\_key\_exchange@{ciphers::elliptic\_curve\_key\_exchange}!addition@{addition}}
\index{addition@{addition}!ciphers::elliptic\_curve\_key\_exchange@{ciphers::elliptic\_curve\_key\_exchange}}
\doxysubsubsection{\texorpdfstring{addition()}{addition()}}
{\footnotesize\ttfamily \label{namespaceciphers_1_1elliptic__curve__key__exchange_acc5fe9c2032fb7582c38a20d1fa69bcf} 
\mbox{\hyperlink{structciphers_1_1elliptic__curve__key__exchange_1_1_point}{Point}} ciphers\+::elliptic\+\_\+curve\+\_\+key\+\_\+exchange\+::addition (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structciphers_1_1elliptic__curve__key__exchange_1_1_point}{Point}}}]{a}{, }\item[{\mbox{\hyperlink{structciphers_1_1elliptic__curve__key__exchange_1_1_point}{Point}}}]{b}{, }\item[{const \mbox{\hyperlink{classuint256__t}{uint256\+\_\+t}} \&}]{curve\+\_\+a\+\_\+coeff}{, }\item[{\mbox{\hyperlink{classuint256__t}{uint256\+\_\+t}}}]{mod}{}\end{DoxyParamCaption})}



Addition of points. 

Add given point to generate third point. More description can be found \href{https://en.wikipedia.org/wiki/Elliptic_curve_point_multiplication\#Point_addition}{\texttt{ here}}, and \href{https://en.wikipedia.org/wiki/Elliptic_curve_point_multiplication\#Point_doubling}{\texttt{ here}} 
\begin{DoxyParams}{Parameters}
{\em a} & First point \\
\hline
{\em b} & Second point \\
\hline
{\em curve\+\_\+a\+\_\+coeff} & Coefficient {\ttfamily a} of the given curve (y\texorpdfstring{$^\wedge$}{\string^}2 = x\texorpdfstring{$^\wedge$}{\string^}3 + ax + b) \% mod \\
\hline
{\em mod} & Given field \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
the resultant point 
\end{DoxyReturn}
Slope

value zero

slope when the line is tangent to curve. This operation is performed while doubling. Taking derivative of {\ttfamily y\texorpdfstring{$^\wedge$}{\string^}2 = x\texorpdfstring{$^\wedge$}{\string^}3 + ax + b} =\texorpdfstring{$>$}{>} {\ttfamily 2y dy = (3 \texorpdfstring{$\ast$}{*} x\texorpdfstring{$^\wedge$}{\string^}2 + a)dx} =\texorpdfstring{$>$}{>} {\ttfamily (dy/dx) = (3x\texorpdfstring{$^\wedge$}{\string^}2 + a)/(2y)}

if y co-\/ordinate is zero, the slope is infinite, return inf. else calculate the slope (here \% mod and store in lambda)
\begin{DoxyCode}{0}
\DoxyCodeLine{00111\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00112\ \ \ \ \ \mbox{\hyperlink{classuint256__t}{uint256\_t}}\ lambda(0);\ \ \textcolor{comment}{///\ Slope}}
\DoxyCodeLine{00113\ \ \ \ \ \mbox{\hyperlink{classuint256__t}{uint256\_t}}\ zero(0);\ \ \ \ \textcolor{comment}{///\ value\ zero}}
\DoxyCodeLine{00114\ \ \ \ \ lambda\ =\ zero\ =\ 0;}
\DoxyCodeLine{00115\ \ \ \ \ \mbox{\hyperlink{classuint256__t}{uint256\_t}}\ inf\ =\ \string~zero;}
\DoxyCodeLine{00116\ \ \ \ \ \textcolor{keywordflow}{if}\ (a.x\ !=\ b.x\ ||\ a.y\ !=\ b.y)\ \{}
\DoxyCodeLine{00117\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Slope\ being\ infinite.}}
\DoxyCodeLine{00118\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (b.x\ ==\ a.x)\ \{}
\DoxyCodeLine{00119\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \{inf,\ inf\};}
\DoxyCodeLine{00120\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00121\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classuint256__t}{uint256\_t}}\ num\ =\ (b.y\ -\/\ a.y\ +\ mod),\ den\ =\ (b.x\ -\/\ a.x\ +\ mod);}
\DoxyCodeLine{00122\ \ \ \ \ \ \ \ \ lambda\ =\ (num\ *\ (exp(den,\ mod\ -\/\ 2,\ mod)))\ \%\ mod;}
\DoxyCodeLine{00123\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{\textcolor{comment}{}}
\DoxyCodeLine{00124\ \textcolor{comment}{\ \ \ \ \ \ \ \ /**}}
\DoxyCodeLine{00125\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ *\ \ slope\ when\ the\ line\ is\ tangent\ to\ curve.\ This\ operation\ is\ performed}}
\DoxyCodeLine{00126\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ *\ while\ doubling.\ Taking\ derivative\ of\ \`{}y\string^2\ =\ x\string^3\ +\ ax\ +\ b`}}
\DoxyCodeLine{00127\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ *\ =>\ \`{}2y\ dy\ =\ (3\ *\ x\string^2\ +\ a)dx`}}
\DoxyCodeLine{00128\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ *\ =>\ \`{}(dy/dx)\ =\ (3x\string^2\ +\ a)/(2y)`}}
\DoxyCodeLine{00129\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ */}\textcolor{comment}{}}
\DoxyCodeLine{00130\ \textcolor{comment}{\ \ \ \ \ \ \ \ /**}}
\DoxyCodeLine{00131\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ *\ if\ y\ co-\/ordinate\ is\ zero,\ the\ slope\ is\ infinite,\ return\ inf.}}
\DoxyCodeLine{00132\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ *\ else\ calculate\ the\ slope\ (here\ \%\ mod\ and\ store\ in\ lambda)}}
\DoxyCodeLine{00133\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ */}}
\DoxyCodeLine{00134\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!a.y)\ \{}
\DoxyCodeLine{00135\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \{inf,\ inf\};}
\DoxyCodeLine{00136\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00137\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classuint256__t}{uint256\_t}}\ axsq\ =\ ((a.x\ *\ a.x))\ \%\ mod;}
\DoxyCodeLine{00138\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Mulitply\ by\ 3\ adjustment}}
\DoxyCodeLine{00139\ \ \ \ \ \ \ \ \ axsq\ +=\ (axsq\ <<\ 1);}
\DoxyCodeLine{00140\ \ \ \ \ \ \ \ \ axsq\ \%=\ mod;}
\DoxyCodeLine{00141\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Mulitply\ by\ 2\ adjustment}}
\DoxyCodeLine{00142\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classuint256__t}{uint256\_t}}\ a\_2\ =\ (a.y\ <<\ 1);}
\DoxyCodeLine{00143\ \ \ \ \ \ \ \ \ lambda\ =}
\DoxyCodeLine{00144\ \ \ \ \ \ \ \ \ \ \ \ \ (((axsq\ +\ curve\_a\_coeff)\ \%\ mod)\ *\ \mbox{\hyperlink{namespaceciphers_1_1elliptic__curve__key__exchange_ac00616a4e40d3cd5cfb4da87d9ff9af0}{exp}}(a\_2,\ mod\ -\/\ 2,\ mod))\ \%\ mod;}
\DoxyCodeLine{00145\ \ \ \ \ \}}
\DoxyCodeLine{00146\ \ \ \ \ \mbox{\hyperlink{struct_point}{Point}}\ c;}
\DoxyCodeLine{00147\ \ \ \ \ \textcolor{comment}{//\ new\ point:\ x\ =\ ((lambda\string^2)\ -\/\ x1\ -\/\ x2)}}
\DoxyCodeLine{00148\ \ \ \ \ \textcolor{comment}{//\ y\ =\ (lambda\ *\ (x1\ -\/\ x))\ -\/\ y1}}
\DoxyCodeLine{00149\ \ \ \ \ c.x\ =\ ((lambda\ *\ lambda)\ \%\ mod\ +\ (mod\ <<\ 1)\ -\/\ a.x\ -\/\ b.x)\ \%\ mod;}
\DoxyCodeLine{00150\ \ \ \ \ c.\mbox{\hyperlink{struct_point_a2e1b5fb2b2a83571f5c0bc0f66a73cf7}{y}}\ =\ (((lambda\ *\ (a.x\ +\ mod\ -\/\ c.x))\ \%\ mod)\ +\ mod\ -\/\ a.y)\ \%\ mod;}
\DoxyCodeLine{00151\ \ \ \ \ \textcolor{keywordflow}{return}\ c;}
\DoxyCodeLine{00152\ \}}

\end{DoxyCode}
\Hypertarget{namespaceciphers_1_1elliptic__curve__key__exchange_ac00616a4e40d3cd5cfb4da87d9ff9af0}\index{ciphers::elliptic\_curve\_key\_exchange@{ciphers::elliptic\_curve\_key\_exchange}!exp@{exp}}
\index{exp@{exp}!ciphers::elliptic\_curve\_key\_exchange@{ciphers::elliptic\_curve\_key\_exchange}}
\doxysubsubsection{\texorpdfstring{exp()}{exp()}}
{\footnotesize\ttfamily \label{namespaceciphers_1_1elliptic__curve__key__exchange_ac00616a4e40d3cd5cfb4da87d9ff9af0} 
\mbox{\hyperlink{classuint256__t}{uint256\+\_\+t}} ciphers\+::elliptic\+\_\+curve\+\_\+key\+\_\+exchange\+::exp (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classuint256__t}{uint256\+\_\+t}}}]{number}{, }\item[{\mbox{\hyperlink{classuint256__t}{uint256\+\_\+t}}}]{power}{, }\item[{const \mbox{\hyperlink{classuint256__t}{uint256\+\_\+t}} \&}]{mod}{}\end{DoxyParamCaption})}



This function calculates number raised to exponent power under modulo mod using \href{https://github.com/TheAlgorithms/C-Plus-Plus/blob/master/math/modular_exponentiation.cpp}{\texttt{ Modular Exponentiation}}. 


\begin{DoxyParams}{Parameters}
{\em number} & integer base \\
\hline
{\em power} & unsigned integer exponent \\
\hline
{\em mod} & integer modulo \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
number raised to power modulo mod 
\end{DoxyReturn}

\begin{DoxyCode}{0}
\DoxyCodeLine{00078\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00079\ \ \ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{power__for__huge__numbers_8cpp_ae249a2af508aa94266023ce8aa81426f}{power}})\ \{}
\DoxyCodeLine{00080\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classuint256__t}{uint256\_t}}(1);}
\DoxyCodeLine{00081\ \ \ \ \ \}}
\DoxyCodeLine{00082\ \ \ \ \ \mbox{\hyperlink{classuint256__t}{uint256\_t}}\ ans(1);}
\DoxyCodeLine{00083\ \ \ \ \ number\ =\ number\ \%\ mod;}
\DoxyCodeLine{00084\ \ \ \ \ \textcolor{keywordflow}{while}\ (\mbox{\hyperlink{power__for__huge__numbers_8cpp_ae249a2af508aa94266023ce8aa81426f}{power}})\ \{}
\DoxyCodeLine{00085\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ ((\mbox{\hyperlink{power__for__huge__numbers_8cpp_ae249a2af508aa94266023ce8aa81426f}{power}}\ \&\ 1))\ \{}
\DoxyCodeLine{00086\ \ \ \ \ \ \ \ \ \ \ \ \ ans\ =\ (ans\ *\ number)\ \%\ mod;}
\DoxyCodeLine{00087\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00088\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{power__for__huge__numbers_8cpp_ae249a2af508aa94266023ce8aa81426f}{power}}\ >>=\ 1;}
\DoxyCodeLine{00089\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{power__for__huge__numbers_8cpp_ae249a2af508aa94266023ce8aa81426f}{power}})\ \{}
\DoxyCodeLine{00090\ \ \ \ \ \ \ \ \ \ \ \ \ number\ =\ (number\ *\ number)\ \%\ mod;}
\DoxyCodeLine{00091\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00092\ \ \ \ \ \}}
\DoxyCodeLine{00093\ \ \ \ \ \textcolor{keywordflow}{return}\ ans;}
\DoxyCodeLine{00094\ \}}

\end{DoxyCode}
\Hypertarget{namespaceciphers_1_1elliptic__curve__key__exchange_a17f3d667241b88115a95282cdd719cb2}\index{ciphers::elliptic\_curve\_key\_exchange@{ciphers::elliptic\_curve\_key\_exchange}!multiply@{multiply}}
\index{multiply@{multiply}!ciphers::elliptic\_curve\_key\_exchange@{ciphers::elliptic\_curve\_key\_exchange}}
\doxysubsubsection{\texorpdfstring{multiply()}{multiply()}}
{\footnotesize\ttfamily \label{namespaceciphers_1_1elliptic__curve__key__exchange_a17f3d667241b88115a95282cdd719cb2} 
\mbox{\hyperlink{structciphers_1_1elliptic__curve__key__exchange_1_1_point}{Point}} ciphers\+::elliptic\+\_\+curve\+\_\+key\+\_\+exchange\+::multiply (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{structciphers_1_1elliptic__curve__key__exchange_1_1_point}{Point}} \&}]{a}{, }\item[{const \mbox{\hyperlink{classuint256__t}{uint256\+\_\+t}} \&}]{curve\+\_\+a\+\_\+coeff}{, }\item[{\mbox{\hyperlink{classuint256__t}{uint256\+\_\+t}}}]{p}{, }\item[{const \mbox{\hyperlink{classuint256__t}{uint256\+\_\+t}} \&}]{mod}{}\end{DoxyParamCaption})}



multiply \doxylink{structciphers_1_1elliptic__curve__key__exchange_1_1_point}{Point} and integer 

Multiply \doxylink{structciphers_1_1elliptic__curve__key__exchange_1_1_point}{Point} by a scalar factor (here it is a private key p). The multiplication is called as \href{https://en.wikipedia.org/wiki/Elliptic_curve_point_multiplication\#Double-and-add}{\texttt{ double and add method}} 
\begin{DoxyParams}{Parameters}
{\em a} & \doxylink{structciphers_1_1elliptic__curve__key__exchange_1_1_point}{Point} to multiply \\
\hline
{\em curve\+\_\+a\+\_\+coeff} & Coefficient of given curve (y\texorpdfstring{$^\wedge$}{\string^}2 = x\texorpdfstring{$^\wedge$}{\string^}3 + ax + b) \% mod \\
\hline
{\em p} & The scalar value \\
\hline
{\em mod} & Given field \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
the resultant point 
\end{DoxyReturn}

\begin{DoxyCode}{0}
\DoxyCodeLine{00166\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00167\ \ \ \ \ \mbox{\hyperlink{structciphers_1_1elliptic__curve__key__exchange_1_1_point}{Point}}\ N\ =\ a;}
\DoxyCodeLine{00168\ \ \ \ \ N.x\ \%=\ mod;}
\DoxyCodeLine{00169\ \ \ \ \ N.y\ \%=\ mod;}
\DoxyCodeLine{00170\ \ \ \ \ \mbox{\hyperlink{classuint256__t}{uint256\_t}}\ inf\{\};}
\DoxyCodeLine{00171\ \ \ \ \ inf\ =\ \mbox{\hyperlink{classuint256__t}{\string~uint256\_t}}(0);}
\DoxyCodeLine{00172\ \ \ \ \ \mbox{\hyperlink{struct_point}{Point}}\ Q\ =\ \{inf,\ inf\};}
\DoxyCodeLine{00173\ \ \ \ \ \textcolor{keywordflow}{while}\ (p)\ \{}
\DoxyCodeLine{00174\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ ((p\ \&\ 1))\ \{}
\DoxyCodeLine{00175\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (Q.x\ ==\ inf\ \&\&\ Q.\mbox{\hyperlink{struct_point_a2e1b5fb2b2a83571f5c0bc0f66a73cf7}{y}}\ ==\ inf)\ \{}
\DoxyCodeLine{00176\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Q.x\ =\ N.x;}
\DoxyCodeLine{00177\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Q.\mbox{\hyperlink{struct_point_a2e1b5fb2b2a83571f5c0bc0f66a73cf7}{y}}\ =\ N.y;}
\DoxyCodeLine{00178\ \ \ \ \ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00179\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Q\ =\ \mbox{\hyperlink{namespaceciphers_1_1elliptic__curve__key__exchange_acc5fe9c2032fb7582c38a20d1fa69bcf}{addition}}(Q,\ N,\ curve\_a\_coeff,\ mod);}
\DoxyCodeLine{00180\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00181\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00182\ \ \ \ \ \ \ \ \ p\ >>=\ 1;}
\DoxyCodeLine{00183\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (p)\ \{}
\DoxyCodeLine{00184\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{data__structures_2sparse__table_8cpp_a10f3ffb3f6f7e1b83d556b9c8de89a5d}{N}}\ =\ \mbox{\hyperlink{namespaceciphers_1_1elliptic__curve__key__exchange_acc5fe9c2032fb7582c38a20d1fa69bcf}{addition}}(N,\ N,\ curve\_a\_coeff,\ mod);}
\DoxyCodeLine{00185\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00186\ \ \ \ \ \}}
\DoxyCodeLine{00187\ \ \ \ \ \textcolor{keywordflow}{return}\ Q;}
\DoxyCodeLine{00188\ \}}

\end{DoxyCode}
