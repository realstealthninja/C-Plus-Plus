\doxysection{machine\+\_\+learning/kohonen\+\_\+som\+\_\+topology.cpp File Reference}
\hypertarget{kohonen__som__topology_8cpp}{}\label{kohonen__som__topology_8cpp}\index{machine\_learning/kohonen\_som\_topology.cpp@{machine\_learning/kohonen\_som\_topology.cpp}}


\href{https://en.wikipedia.org/wiki/Self-organizing_map}{\texttt{ Kohonen self organizing map}} (topological map)  


{\ttfamily \#include $<$algorithm$>$}\newline
{\ttfamily \#include $<$array$>$}\newline
{\ttfamily \#include $<$cerrno$>$}\newline
{\ttfamily \#include $<$cmath$>$}\newline
{\ttfamily \#include $<$cstdlib$>$}\newline
{\ttfamily \#include $<$cstring$>$}\newline
{\ttfamily \#include $<$ctime$>$}\newline
{\ttfamily \#include $<$fstream$>$}\newline
{\ttfamily \#include $<$iostream$>$}\newline
{\ttfamily \#include $<$valarray$>$}\newline
{\ttfamily \#include $<$vector$>$}\newline
\doxysubsubsection*{Namespaces}
\begin{DoxyCompactItemize}
\item 
namespace \mbox{\hyperlink{namespacemachine__learning}{machine\+\_\+learning}}
\begin{DoxyCompactList}\small\item\em \href{https://en.wikipedia.org/wiki/A*_search_algorithm}{\texttt{ A\texorpdfstring{$\ast$}{*} search algorithm}} \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
double \mbox{\hyperlink{group__machine__learning_gaf5ce14f026d6d231bef29161bac2b485}{\+\_\+random}} (double a, double b)
\item 
int \mbox{\hyperlink{group__machine__learning_gabc90175770bf0d5853c466e14993a08c}{save\+\_\+2d\+\_\+data}} (const char \texorpdfstring{$\ast$}{*}fname, const std\+::vector$<$ std\+::valarray$<$ double $>$ $>$ \&X)
\item 
void \mbox{\hyperlink{group__machine__learning_ga60f9186ccb682724a8792a2bf81e9b9e}{get\+\_\+min\+\_\+2d}} (const std\+::vector$<$ std\+::valarray$<$ double $>$ $>$ \&X, double \texorpdfstring{$\ast$}{*}val, int \texorpdfstring{$\ast$}{*}x\+\_\+idx, int \texorpdfstring{$\ast$}{*}y\+\_\+idx)
\item 
int \mbox{\hyperlink{namespacemachine__learning_aa72a53c88203fde278f1fe6c3afe5b07}{machine\+\_\+learning\+::save\+\_\+u\+\_\+matrix}} (const char \texorpdfstring{$\ast$}{*}fname, const std\+::vector$<$ std\+::vector$<$ std\+::valarray$<$ double $>$ $>$ $>$ \&W)
\item 
double \mbox{\hyperlink{namespacemachine__learning_ae868ad43698a1d69ba46ea3827d7d2c3}{machine\+\_\+learning\+::update\+\_\+weights}} (const std\+::valarray$<$ double $>$ \&X, std\+::vector$<$ std\+::vector$<$ std\+::valarray$<$ double $>$ $>$ $>$ \texorpdfstring{$\ast$}{*}W, std\+::vector$<$ std\+::valarray$<$ double $>$ $>$ \texorpdfstring{$\ast$}{*}D, double alpha, int R)
\item 
void \mbox{\hyperlink{namespacemachine__learning_ac43d294e21a0c4fa33c53757df054576}{machine\+\_\+learning\+::kohonen\+\_\+som}} (const std\+::vector$<$ std\+::valarray$<$ double $>$ $>$ \&X, std\+::vector$<$ std\+::vector$<$ std\+::valarray$<$ double $>$ $>$ $>$ \texorpdfstring{$\ast$}{*}W, double alpha\+\_\+min)
\item 
void \mbox{\hyperlink{kohonen__som__topology_8cpp_a48efb079040c7aaa3a4917a0e486cba9}{test\+\_\+2d\+\_\+classes}} (std\+::vector$<$ std\+::valarray$<$ double $>$ $>$ \texorpdfstring{$\ast$}{*}\mbox{\hyperlink{hash__search_8cpp_a6e1a77282bc65ad359d753d25df23243}{data}})
\item 
void \mbox{\hyperlink{kohonen__som__topology_8cpp_a1440a7779ac56f47a3f355ce4a8c7da0}{test1}} ()
\item 
void \mbox{\hyperlink{kohonen__som__topology_8cpp_a1302662a56ebf67a21249270b017297e}{test\+\_\+3d\+\_\+classes1}} (std\+::vector$<$ std\+::valarray$<$ double $>$ $>$ \texorpdfstring{$\ast$}{*}\mbox{\hyperlink{hash__search_8cpp_a6e1a77282bc65ad359d753d25df23243}{data}})
\item 
void \mbox{\hyperlink{kohonen__som__topology_8cpp_a0283886819c7c140a023582b7269e2d0}{test2}} ()
\item 
void \mbox{\hyperlink{kohonen__som__topology_8cpp_a4b7ab643f6a5002f991837de46f70653}{test\+\_\+3d\+\_\+classes2}} (std\+::vector$<$ std\+::valarray$<$ double $>$ $>$ \texorpdfstring{$\ast$}{*}\mbox{\hyperlink{hash__search_8cpp_a6e1a77282bc65ad359d753d25df23243}{data}})
\item 
void \mbox{\hyperlink{kohonen__som__topology_8cpp_a6d0455dd5c30adda100e95f0423c786e}{test3}} ()
\item 
double \mbox{\hyperlink{kohonen__som__topology_8cpp_a2256c10b16edba377b64a44b6c656908}{get\+\_\+clock\+\_\+diff}} (clock\+\_\+t start\+\_\+t, clock\+\_\+t end\+\_\+t)
\item 
int \mbox{\hyperlink{kohonen__som__topology_8cpp_a3c04138a5bfe5d72780bb7e82a18e627}{main}} (int argc, char \texorpdfstring{$\ast$}{*}\texorpdfstring{$\ast$}{*}argv)
\end{DoxyCompactItemize}
\doxysubsubsection*{Variables}
\begin{DoxyCompactItemize}
\item 
constexpr double \mbox{\hyperlink{namespacemachine__learning_a7220dbb7fa896d83bfb7a50e4fce1786}{machine\+\_\+learning\+::\+MIN\+\_\+\+DISTANCE}} = 1e-\/4
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
\href{https://en.wikipedia.org/wiki/Self-organizing_map}{\texttt{ Kohonen self organizing map}} (topological map) 

\begin{DoxyAuthor}{Author}
\href{https://github.com/kvedala}{\texttt{ Krishna Vedala}}
\end{DoxyAuthor}


This example implements a powerful unsupervised learning algorithm called as a self organizing map. The algorithm creates a connected network of weights that closely follows the given data points. This thus creates a topological map of the given data i.\+e., it maintains the relationship between varipus data points in a much higher dimesional space by creating an equivalent in a 2-\/dimensional space.  \begin{DoxyNote}{Note}
This C++ version of the program is considerable slower than its \href{https://github.com/kvedala/C/blob/master/machine_learning/kohonen_som_trace.c}{\texttt{ C counterpart}} 

The compiled code is much slower when compiled with MS Visual C++ 2019 than with GCC on windows 
\end{DoxyNote}
\begin{DoxySeeAlso}{See also}
\doxylink{kohonen__som__trace_8cpp}{kohonen\+\_\+som\+\_\+trace.\+cpp} 
\end{DoxySeeAlso}


\doxysubsection{Function Documentation}
\Hypertarget{kohonen__som__topology_8cpp_a2256c10b16edba377b64a44b6c656908}\index{kohonen\_som\_topology.cpp@{kohonen\_som\_topology.cpp}!get\_clock\_diff@{get\_clock\_diff}}
\index{get\_clock\_diff@{get\_clock\_diff}!kohonen\_som\_topology.cpp@{kohonen\_som\_topology.cpp}}
\doxysubsubsection{\texorpdfstring{get\_clock\_diff()}{get\_clock\_diff()}}
{\footnotesize\ttfamily \label{kohonen__som__topology_8cpp_a2256c10b16edba377b64a44b6c656908} 
double get\+\_\+clock\+\_\+diff (\begin{DoxyParamCaption}\item[{clock\+\_\+t}]{start\+\_\+t}{, }\item[{clock\+\_\+t}]{end\+\_\+t}{}\end{DoxyParamCaption})}

Convert clock cycle difference to time in seconds


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em start\+\_\+t} & start clock \\
\hline
\mbox{\texttt{ in}}  & {\em end\+\_\+t} & end clock \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
time difference in seconds 
\end{DoxyReturn}

\begin{DoxyCode}{0}
\DoxyCodeLine{00577\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00578\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{double}\textcolor{keyword}{>}(end\_t\ -\/\ start\_t)\ /\ CLOCKS\_PER\_SEC;}
\DoxyCodeLine{00579\ \}}

\end{DoxyCode}
\Hypertarget{kohonen__som__topology_8cpp_a3c04138a5bfe5d72780bb7e82a18e627}\index{kohonen\_som\_topology.cpp@{kohonen\_som\_topology.cpp}!main@{main}}
\index{main@{main}!kohonen\_som\_topology.cpp@{kohonen\_som\_topology.cpp}}
\doxysubsubsection{\texorpdfstring{main()}{main()}}
{\footnotesize\ttfamily \label{kohonen__som__topology_8cpp_a3c04138a5bfe5d72780bb7e82a18e627} 
int main (\begin{DoxyParamCaption}\item[{int}]{argc}{, }\item[{char \texorpdfstring{$\ast$}{*}\texorpdfstring{$\ast$}{*}}]{argv}{}\end{DoxyParamCaption})}

Main function 
\begin{DoxyCode}{0}
\DoxyCodeLine{00582\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00583\ \textcolor{preprocessor}{\#ifdef\ \_OPENMP}}
\DoxyCodeLine{00584\ \ \ \ \ std::cout\ <<\ \textcolor{stringliteral}{"{}Using\ OpenMP\ based\ parallelization\(\backslash\)n"{}};}
\DoxyCodeLine{00585\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{00586\ \ \ \ \ std::cout\ <<\ \textcolor{stringliteral}{"{}NOT\ using\ OpenMP\ based\ parallelization\(\backslash\)n"{}};}
\DoxyCodeLine{00587\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00588\ }
\DoxyCodeLine{00589\ \ \ \ \ std::srand(std::time(\textcolor{keyword}{nullptr}));}
\DoxyCodeLine{00590\ }
\DoxyCodeLine{00591\ \ \ \ \ std::clock\_t\ start\_clk\ =\ std::clock();}
\DoxyCodeLine{00592\ \ \ \ \ \mbox{\hyperlink{kohonen__som__topology_8cpp_a1440a7779ac56f47a3f355ce4a8c7da0}{test1}}();}
\DoxyCodeLine{00593\ \ \ \ \ \textcolor{keyword}{auto}\ end\_clk\ =\ std::clock();}
\DoxyCodeLine{00594\ \ \ \ \ std::cout\ <<\ \textcolor{stringliteral}{"{}Test\ 1\ completed\ in\ "{}}\ <<\ \mbox{\hyperlink{kohonen__som__topology_8cpp_a2256c10b16edba377b64a44b6c656908}{get\_clock\_diff}}(start\_clk,\ end\_clk)}
\DoxyCodeLine{00595\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}\ sec\(\backslash\)n"{}};}
\DoxyCodeLine{00596\ }
\DoxyCodeLine{00597\ \ \ \ \ start\_clk\ =\ std::clock();}
\DoxyCodeLine{00598\ \ \ \ \ \mbox{\hyperlink{kohonen__som__topology_8cpp_a0283886819c7c140a023582b7269e2d0}{test2}}();}
\DoxyCodeLine{00599\ \ \ \ \ end\_clk\ =\ std::clock();}
\DoxyCodeLine{00600\ \ \ \ \ std::cout\ <<\ \textcolor{stringliteral}{"{}Test\ 2\ completed\ in\ "{}}\ <<\ \mbox{\hyperlink{kohonen__som__topology_8cpp_a2256c10b16edba377b64a44b6c656908}{get\_clock\_diff}}(start\_clk,\ end\_clk)}
\DoxyCodeLine{00601\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}\ sec\(\backslash\)n"{}};}
\DoxyCodeLine{00602\ }
\DoxyCodeLine{00603\ \ \ \ \ start\_clk\ =\ std::clock();}
\DoxyCodeLine{00604\ \ \ \ \ \mbox{\hyperlink{kohonen__som__topology_8cpp_a6d0455dd5c30adda100e95f0423c786e}{test3}}();}
\DoxyCodeLine{00605\ \ \ \ \ end\_clk\ =\ std::clock();}
\DoxyCodeLine{00606\ \ \ \ \ std::cout\ <<\ \textcolor{stringliteral}{"{}Test\ 3\ completed\ in\ "{}}\ <<\ \mbox{\hyperlink{kohonen__som__topology_8cpp_a2256c10b16edba377b64a44b6c656908}{get\_clock\_diff}}(start\_clk,\ end\_clk)}
\DoxyCodeLine{00607\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}\ sec\(\backslash\)n"{}};}
\DoxyCodeLine{00608\ }
\DoxyCodeLine{00609\ \ \ \ \ std::cout}
\DoxyCodeLine{00610\ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}(Note:\ Calculated\ times\ include:\ creating\ test\ sets,\ training\ "{}}}
\DoxyCodeLine{00611\ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}model\ and\ writing\ files\ to\ disk.)\(\backslash\)n\(\backslash\)n"{}};}
\DoxyCodeLine{00612\ \ \ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{00613\ \}}

\end{DoxyCode}
\Hypertarget{kohonen__som__topology_8cpp_a1440a7779ac56f47a3f355ce4a8c7da0}\index{kohonen\_som\_topology.cpp@{kohonen\_som\_topology.cpp}!test1@{test1}}
\index{test1@{test1}!kohonen\_som\_topology.cpp@{kohonen\_som\_topology.cpp}}
\doxysubsubsection{\texorpdfstring{test1()}{test1()}}
{\footnotesize\ttfamily \label{kohonen__som__topology_8cpp_a1440a7779ac56f47a3f355ce4a8c7da0} 
void test1 (\begin{DoxyParamCaption}{}{}\end{DoxyParamCaption})}

Test that creates a random set of points distributed in four clusters in circumference of a circle and trains an SOM that finds that circular pattern. The following \href{https://en.wikipedia.org/wiki/Comma-separated_values}{\texttt{ CSV}} files are created to validate the execution\+:
\begin{DoxyItemize}
\item {\ttfamily test1.\+csv}\+: random test samples points with a circular pattern
\item {\ttfamily w11.\+csv}\+: initial random map
\item {\ttfamily w12.\+csv}\+: trained SOM map 
\end{DoxyItemize}
\begin{DoxyCode}{0}
\DoxyCodeLine{00369\ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00370\ \ \ \ \ \textcolor{keywordtype}{int}\ j\ =\ 0,\ \mbox{\hyperlink{data__structures_2sparse__table_8cpp_a10f3ffb3f6f7e1b83d556b9c8de89a5d}{N}}\ =\ 300;}
\DoxyCodeLine{00371\ \ \ \ \ \textcolor{keywordtype}{int}\ features\ =\ 2;}
\DoxyCodeLine{00372\ \ \ \ \ \textcolor{keywordtype}{int}\ num\_out\ =\ 30;}
\DoxyCodeLine{00373\ \ \ \ \ std::vector<std::valarray<double>>\ X(N);}
\DoxyCodeLine{00374\ \ \ \ \ std::vector<std::vector<std::valarray<double>>>\ W(num\_out);}
\DoxyCodeLine{00375\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ std::max(num\_out,\ N);\ i++)\ \{}
\DoxyCodeLine{00376\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ loop\ till\ max(N,\ num\_out)}}
\DoxyCodeLine{00377\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (i\ <\ N)\ \{\ \ \textcolor{comment}{//\ only\ add\ new\ arrays\ if\ i\ <\ N}}
\DoxyCodeLine{00378\ \ \ \ \ \ \ \ \ \ \ \ \ X[i]\ =\ std::valarray<double>(features);}
\DoxyCodeLine{00379\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00380\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (i\ <\ num\_out)\ \{\ \ \textcolor{comment}{//\ only\ add\ new\ arrays\ if\ i\ <\ num\_out}}
\DoxyCodeLine{00381\ \ \ \ \ \ \ \ \ \ \ \ \ W[i]\ =\ std::vector<std::valarray<double>>(num\_out);}
\DoxyCodeLine{00382\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ k\ =\ 0;\ \mbox{\hyperlink{composite__simpson__rule_8cpp_a1b74d828b33760094906797042b89442}{k}}\ <\ num\_out;\ \mbox{\hyperlink{composite__simpson__rule_8cpp_a1b74d828b33760094906797042b89442}{k}}++)\ \{}
\DoxyCodeLine{00383\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ W[i][\mbox{\hyperlink{composite__simpson__rule_8cpp_a1b74d828b33760094906797042b89442}{k}}]\ =\ std::valarray<double>(features);}
\DoxyCodeLine{00384\ \textcolor{preprocessor}{\#ifdef\ \_OPENMP}}
\DoxyCodeLine{00385\ \textcolor{preprocessor}{\#pragma\ omp\ for}}
\DoxyCodeLine{00386\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00387\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (j\ =\ 0;\ j\ <\ features;\ j++)\ \{}
\DoxyCodeLine{00388\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ preallocate\ with\ random\ initial\ weights}}
\DoxyCodeLine{00389\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ W[i][\mbox{\hyperlink{composite__simpson__rule_8cpp_a1b74d828b33760094906797042b89442}{k}}][j]\ =\ \mbox{\hyperlink{group__machine__learning_gaf5ce14f026d6d231bef29161bac2b485}{\_random}}(-\/10,\ 10);}
\DoxyCodeLine{00390\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00391\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00392\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00393\ \ \ \ \ \}}
\DoxyCodeLine{00394\ }
\DoxyCodeLine{00395\ \ \ \ \ \mbox{\hyperlink{kohonen__som__topology_8cpp_a48efb079040c7aaa3a4917a0e486cba9}{test\_2d\_classes}}(\&X);\ \ \textcolor{comment}{//\ create\ test\ data\ around\ circumference\ of\ a\ circle}}
\DoxyCodeLine{00396\ \ \ \ \ \mbox{\hyperlink{group__machine__learning_gabc90175770bf0d5853c466e14993a08c}{save\_2d\_data}}(\textcolor{stringliteral}{"{}test1.csv"{}},\ X);\ \ \textcolor{comment}{//\ save\ test\ data\ points}}
\DoxyCodeLine{00397\ \ \ \ \ save\_u\_matrix(\textcolor{stringliteral}{"{}w11.csv"{}},\ W);\ \ \ \textcolor{comment}{//\ save\ initial\ random\ weights}}
\DoxyCodeLine{00398\ \ \ \ \ kohonen\_som(X,\ \&W,\ 1e-\/4);\ \ \ \ \ \ \textcolor{comment}{//\ train\ the\ SOM}}
\DoxyCodeLine{00399\ \ \ \ \ save\_u\_matrix(\textcolor{stringliteral}{"{}w12.csv"{}},\ W);\ \ \ \textcolor{comment}{//\ save\ the\ resultant\ weights}}
\DoxyCodeLine{00400\ \}}

\end{DoxyCode}
\Hypertarget{kohonen__som__topology_8cpp_a0283886819c7c140a023582b7269e2d0}\index{kohonen\_som\_topology.cpp@{kohonen\_som\_topology.cpp}!test2@{test2}}
\index{test2@{test2}!kohonen\_som\_topology.cpp@{kohonen\_som\_topology.cpp}}
\doxysubsubsection{\texorpdfstring{test2()}{test2()}}
{\footnotesize\ttfamily \label{kohonen__som__topology_8cpp_a0283886819c7c140a023582b7269e2d0} 
void test2 (\begin{DoxyParamCaption}{}{}\end{DoxyParamCaption})}

Test that creates a random set of points distributed in 4 clusters in 3D space and trains an SOM that finds the topological pattern. The following \href{https://en.wikipedia.org/wiki/Comma-separated_values}{\texttt{ CSV}} files are created to validate the execution\+:
\begin{DoxyItemize}
\item {\ttfamily test2.\+csv}\+: random test samples points with a lamniscate pattern
\item {\ttfamily w21.\+csv}\+: initial random map
\item {\ttfamily w22.\+csv}\+: trained SOM map 
\end{DoxyItemize}
\begin{DoxyCode}{0}
\DoxyCodeLine{00451\ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00452\ \ \ \ \ \textcolor{keywordtype}{int}\ j\ =\ 0,\ \mbox{\hyperlink{data__structures_2sparse__table_8cpp_a10f3ffb3f6f7e1b83d556b9c8de89a5d}{N}}\ =\ 300;}
\DoxyCodeLine{00453\ \ \ \ \ \textcolor{keywordtype}{int}\ features\ =\ 3;}
\DoxyCodeLine{00454\ \ \ \ \ \textcolor{keywordtype}{int}\ num\_out\ =\ 30;}
\DoxyCodeLine{00455\ \ \ \ \ std::vector<std::valarray<double>>\ X(N);}
\DoxyCodeLine{00456\ \ \ \ \ std::vector<std::vector<std::valarray<double>>>\ W(num\_out);}
\DoxyCodeLine{00457\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ std::max(num\_out,\ N);\ i++)\ \{}
\DoxyCodeLine{00458\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ loop\ till\ max(N,\ num\_out)}}
\DoxyCodeLine{00459\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (i\ <\ N)\ \{\ \ \textcolor{comment}{//\ only\ add\ new\ arrays\ if\ i\ <\ N}}
\DoxyCodeLine{00460\ \ \ \ \ \ \ \ \ \ \ \ \ X[i]\ =\ std::valarray<double>(features);}
\DoxyCodeLine{00461\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00462\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (i\ <\ num\_out)\ \{\ \ \textcolor{comment}{//\ only\ add\ new\ arrays\ if\ i\ <\ num\_out}}
\DoxyCodeLine{00463\ \ \ \ \ \ \ \ \ \ \ \ \ W[i]\ =\ std::vector<std::valarray<double>>(num\_out);}
\DoxyCodeLine{00464\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ k\ =\ 0;\ \mbox{\hyperlink{composite__simpson__rule_8cpp_a1b74d828b33760094906797042b89442}{k}}\ <\ num\_out;\ \mbox{\hyperlink{composite__simpson__rule_8cpp_a1b74d828b33760094906797042b89442}{k}}++)\ \{}
\DoxyCodeLine{00465\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ W[i][\mbox{\hyperlink{composite__simpson__rule_8cpp_a1b74d828b33760094906797042b89442}{k}}]\ =\ std::valarray<double>(features);}
\DoxyCodeLine{00466\ \textcolor{preprocessor}{\#ifdef\ \_OPENMP}}
\DoxyCodeLine{00467\ \textcolor{preprocessor}{\#pragma\ omp\ for}}
\DoxyCodeLine{00468\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00469\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (j\ =\ 0;\ j\ <\ features;\ j++)\ \{}
\DoxyCodeLine{00470\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ preallocate\ with\ random\ initial\ weights}}
\DoxyCodeLine{00471\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ W[i][\mbox{\hyperlink{composite__simpson__rule_8cpp_a1b74d828b33760094906797042b89442}{k}}][j]\ =\ \mbox{\hyperlink{group__machine__learning_gaf5ce14f026d6d231bef29161bac2b485}{\_random}}(-\/10,\ 10);}
\DoxyCodeLine{00472\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00473\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00474\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00475\ \ \ \ \ \}}
\DoxyCodeLine{00476\ }
\DoxyCodeLine{00477\ \ \ \ \ \mbox{\hyperlink{kohonen__som__topology_8cpp_a1302662a56ebf67a21249270b017297e}{test\_3d\_classes1}}(\&X);\ \ \textcolor{comment}{//\ create\ test\ data\ around\ circumference\ of\ a\ circle}}
\DoxyCodeLine{00478\ \ \ \ \ \mbox{\hyperlink{group__machine__learning_gabc90175770bf0d5853c466e14993a08c}{save\_2d\_data}}(\textcolor{stringliteral}{"{}test2.csv"{}},\ X);\ \ \textcolor{comment}{//\ save\ test\ data\ points}}
\DoxyCodeLine{00479\ \ \ \ \ save\_u\_matrix(\textcolor{stringliteral}{"{}w21.csv"{}},\ W);\ \ \ \textcolor{comment}{//\ save\ initial\ random\ weights}}
\DoxyCodeLine{00480\ \ \ \ \ kohonen\_som(X,\ \&W,\ 1e-\/4);\ \ \ \ \ \ \textcolor{comment}{//\ train\ the\ SOM}}
\DoxyCodeLine{00481\ \ \ \ \ save\_u\_matrix(\textcolor{stringliteral}{"{}w22.csv"{}},\ W);\ \ \ \textcolor{comment}{//\ save\ the\ resultant\ weights}}
\DoxyCodeLine{00482\ \}}

\end{DoxyCode}
\Hypertarget{kohonen__som__topology_8cpp_a6d0455dd5c30adda100e95f0423c786e}\index{kohonen\_som\_topology.cpp@{kohonen\_som\_topology.cpp}!test3@{test3}}
\index{test3@{test3}!kohonen\_som\_topology.cpp@{kohonen\_som\_topology.cpp}}
\doxysubsubsection{\texorpdfstring{test3()}{test3()}}
{\footnotesize\ttfamily \label{kohonen__som__topology_8cpp_a6d0455dd5c30adda100e95f0423c786e} 
void test3 (\begin{DoxyParamCaption}{}{}\end{DoxyParamCaption})}

Test that creates a random set of points distributed in eight clusters in 3D space and trains an SOM that finds the topological pattern. The following \href{https://en.wikipedia.org/wiki/Comma-separated_values}{\texttt{ CSV}} files are created to validate the execution\+:
\begin{DoxyItemize}
\item {\ttfamily test3.\+csv}\+: random test samples points with a circular pattern
\item {\ttfamily w31.\+csv}\+: initial random map
\item {\ttfamily w32.\+csv}\+: trained SOM map 
\end{DoxyItemize}
\begin{DoxyCode}{0}
\DoxyCodeLine{00537\ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00538\ \ \ \ \ \textcolor{keywordtype}{int}\ j\ =\ 0,\ \mbox{\hyperlink{data__structures_2sparse__table_8cpp_a10f3ffb3f6f7e1b83d556b9c8de89a5d}{N}}\ =\ 500;}
\DoxyCodeLine{00539\ \ \ \ \ \textcolor{keywordtype}{int}\ features\ =\ 3;}
\DoxyCodeLine{00540\ \ \ \ \ \textcolor{keywordtype}{int}\ num\_out\ =\ 30;}
\DoxyCodeLine{00541\ \ \ \ \ std::vector<std::valarray<double>>\ X(N);}
\DoxyCodeLine{00542\ \ \ \ \ std::vector<std::vector<std::valarray<double>>>\ W(num\_out);}
\DoxyCodeLine{00543\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ std::max(num\_out,\ N);\ i++)\ \{}
\DoxyCodeLine{00544\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ loop\ till\ max(N,\ num\_out)}}
\DoxyCodeLine{00545\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (i\ <\ N)\ \{\ \ \textcolor{comment}{//\ only\ add\ new\ arrays\ if\ i\ <\ N}}
\DoxyCodeLine{00546\ \ \ \ \ \ \ \ \ \ \ \ \ X[i]\ =\ std::valarray<double>(features);}
\DoxyCodeLine{00547\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00548\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (i\ <\ num\_out)\ \{\ \ \textcolor{comment}{//\ only\ add\ new\ arrays\ if\ i\ <\ num\_out}}
\DoxyCodeLine{00549\ \ \ \ \ \ \ \ \ \ \ \ \ W[i]\ =\ std::vector<std::valarray<double>>(num\_out);}
\DoxyCodeLine{00550\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ k\ =\ 0;\ \mbox{\hyperlink{composite__simpson__rule_8cpp_a1b74d828b33760094906797042b89442}{k}}\ <\ num\_out;\ \mbox{\hyperlink{composite__simpson__rule_8cpp_a1b74d828b33760094906797042b89442}{k}}++)\ \{}
\DoxyCodeLine{00551\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ W[i][\mbox{\hyperlink{composite__simpson__rule_8cpp_a1b74d828b33760094906797042b89442}{k}}]\ =\ std::valarray<double>(features);}
\DoxyCodeLine{00552\ \textcolor{preprocessor}{\#ifdef\ \_OPENMP}}
\DoxyCodeLine{00553\ \textcolor{preprocessor}{\#pragma\ omp\ for}}
\DoxyCodeLine{00554\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00555\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (j\ =\ 0;\ j\ <\ features;\ j++)\ \{}
\DoxyCodeLine{00556\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ preallocate\ with\ random\ initial\ weights}}
\DoxyCodeLine{00557\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ W[i][\mbox{\hyperlink{composite__simpson__rule_8cpp_a1b74d828b33760094906797042b89442}{k}}][j]\ =\ \mbox{\hyperlink{group__machine__learning_gaf5ce14f026d6d231bef29161bac2b485}{\_random}}(-\/10,\ 10);}
\DoxyCodeLine{00558\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00559\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00560\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00561\ \ \ \ \ \}}
\DoxyCodeLine{00562\ }
\DoxyCodeLine{00563\ \ \ \ \ \mbox{\hyperlink{kohonen__som__topology_8cpp_a4b7ab643f6a5002f991837de46f70653}{test\_3d\_classes2}}(\&X);\ \ \textcolor{comment}{//\ create\ test\ data\ around\ circumference\ of\ a\ circle}}
\DoxyCodeLine{00564\ \ \ \ \ \mbox{\hyperlink{group__machine__learning_gabc90175770bf0d5853c466e14993a08c}{save\_2d\_data}}(\textcolor{stringliteral}{"{}test3.csv"{}},\ X);\ \ \textcolor{comment}{//\ save\ test\ data\ points}}
\DoxyCodeLine{00565\ \ \ \ \ save\_u\_matrix(\textcolor{stringliteral}{"{}w31.csv"{}},\ W);\ \ \ \textcolor{comment}{//\ save\ initial\ random\ weights}}
\DoxyCodeLine{00566\ \ \ \ \ kohonen\_som(X,\ \&W,\ 1e-\/4);\ \ \ \ \ \ \textcolor{comment}{//\ train\ the\ SOM}}
\DoxyCodeLine{00567\ \ \ \ \ save\_u\_matrix(\textcolor{stringliteral}{"{}w32.csv"{}},\ W);\ \ \ \textcolor{comment}{//\ save\ the\ resultant\ weights}}
\DoxyCodeLine{00568\ \}}

\end{DoxyCode}
\Hypertarget{kohonen__som__topology_8cpp_a48efb079040c7aaa3a4917a0e486cba9}\index{kohonen\_som\_topology.cpp@{kohonen\_som\_topology.cpp}!test\_2d\_classes@{test\_2d\_classes}}
\index{test\_2d\_classes@{test\_2d\_classes}!kohonen\_som\_topology.cpp@{kohonen\_som\_topology.cpp}}
\doxysubsubsection{\texorpdfstring{test\_2d\_classes()}{test\_2d\_classes()}}
{\footnotesize\ttfamily \label{kohonen__som__topology_8cpp_a48efb079040c7aaa3a4917a0e486cba9} 
void test\+\_\+2d\+\_\+classes (\begin{DoxyParamCaption}\item[{std\+::vector$<$ std\+::valarray$<$ double $>$ $>$ \texorpdfstring{$\ast$}{*}}]{data}{}\end{DoxyParamCaption})}

Creates a random set of points distributed in four clusters in 3D space with centroids at the points
\begin{DoxyItemize}
\item $(0,5, 0.5, 0.5)$
\item $(0,5,-0.5, -0.5)$
\item $(-0,5, 0.5, 0.5)$
\item $(-0,5,-0.5, -0.5)$
\end{DoxyItemize}


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ out}}  & {\em data} & matrix to store data in \\
\hline
\end{DoxyParams}

\begin{DoxyCode}{0}
\DoxyCodeLine{00330\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00331\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{data__structures_2sparse__table_8cpp_a10f3ffb3f6f7e1b83d556b9c8de89a5d}{N}}\ =\ \mbox{\hyperlink{hash__search_8cpp_a6e1a77282bc65ad359d753d25df23243}{data}}-\/>size();}
\DoxyCodeLine{00332\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ R\ =\ 0.3;\ \ \textcolor{comment}{//\ radius\ of\ cluster}}
\DoxyCodeLine{00333\ \ \ \ \ \textcolor{keywordtype}{int}\ i\ =\ 0;}
\DoxyCodeLine{00334\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ num\_classes\ =\ 4;}
\DoxyCodeLine{00335\ \ \ \ \ std::array<std::array<double,\ 2>,\ num\_classes>\ centres\ =\ \{}
\DoxyCodeLine{00336\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ centres\ of\ each\ class\ cluster}}
\DoxyCodeLine{00337\ \ \ \ \ \ \ \ \ std::array<double,\ 2>(\{.5,\ .5\}),\ \ \ \textcolor{comment}{//\ centre\ of\ class\ 1}}
\DoxyCodeLine{00338\ \ \ \ \ \ \ \ \ std::array<double,\ 2>(\{.5,\ -\/.5\}),\ \ \textcolor{comment}{//\ centre\ of\ class\ 2}}
\DoxyCodeLine{00339\ \ \ \ \ \ \ \ \ std::array<double,\ 2>(\{-\/.5,\ .5\}),\ \ \textcolor{comment}{//\ centre\ of\ class\ 3}}
\DoxyCodeLine{00340\ \ \ \ \ \ \ \ \ std::array<double,\ 2>(\{-\/.5,\ -\/.5\})\ \ \textcolor{comment}{//\ centre\ of\ class\ 4}}
\DoxyCodeLine{00341\ \ \ \ \ \};}
\DoxyCodeLine{00342\ }
\DoxyCodeLine{00343\ \textcolor{preprocessor}{\#ifdef\ \_OPENMP}}
\DoxyCodeLine{00344\ \textcolor{preprocessor}{\#pragma\ omp\ for}}
\DoxyCodeLine{00345\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00346\ \ \ \ \ \textcolor{keywordflow}{for}\ (i\ =\ 0;\ i\ <\ \mbox{\hyperlink{data__structures_2sparse__table_8cpp_a10f3ffb3f6f7e1b83d556b9c8de89a5d}{N}};\ i++)\ \{}
\DoxyCodeLine{00347\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ select\ a\ random\ class\ for\ the\ point}}
\DoxyCodeLine{00348\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ cls\ =\ std::rand()\ \%\ num\_classes;}
\DoxyCodeLine{00349\ }
\DoxyCodeLine{00350\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ create\ random\ coordinates\ (x,y,z)\ around\ the\ centre\ of\ the\ class}}
\DoxyCodeLine{00351\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{hash__search_8cpp_a6e1a77282bc65ad359d753d25df23243}{data}}[0][i][0]\ =\ \mbox{\hyperlink{group__machine__learning_gaf5ce14f026d6d231bef29161bac2b485}{\_random}}(centres[cls][0]\ -\/\ R,\ centres[cls][0]\ +\ R);}
\DoxyCodeLine{00352\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{hash__search_8cpp_a6e1a77282bc65ad359d753d25df23243}{data}}[0][i][1]\ =\ \mbox{\hyperlink{group__machine__learning_gaf5ce14f026d6d231bef29161bac2b485}{\_random}}(centres[cls][1]\ -\/\ R,\ centres[cls][1]\ +\ R);}
\DoxyCodeLine{00353\ }
\DoxyCodeLine{00354\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ The\ follosing\ can\ also\ be\ used}}
\DoxyCodeLine{00355\ \textcolor{comment}{\ \ \ \ \ \ \ \ for\ (int\ j\ =\ 0;\ j\ <\ 2;\ j++)}}
\DoxyCodeLine{00356\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ data[i][j]\ =\ \_random(centres[class][j]\ -\/\ R,\ centres[class][j]\ +\ R);}}
\DoxyCodeLine{00357\ \textcolor{comment}{\ \ \ \ \ \ \ \ */}}
\DoxyCodeLine{00358\ \ \ \ \ \}}
\DoxyCodeLine{00359\ \}}

\end{DoxyCode}
\Hypertarget{kohonen__som__topology_8cpp_a1302662a56ebf67a21249270b017297e}\index{kohonen\_som\_topology.cpp@{kohonen\_som\_topology.cpp}!test\_3d\_classes1@{test\_3d\_classes1}}
\index{test\_3d\_classes1@{test\_3d\_classes1}!kohonen\_som\_topology.cpp@{kohonen\_som\_topology.cpp}}
\doxysubsubsection{\texorpdfstring{test\_3d\_classes1()}{test\_3d\_classes1()}}
{\footnotesize\ttfamily \label{kohonen__som__topology_8cpp_a1302662a56ebf67a21249270b017297e} 
void test\+\_\+3d\+\_\+classes1 (\begin{DoxyParamCaption}\item[{std\+::vector$<$ std\+::valarray$<$ double $>$ $>$ \texorpdfstring{$\ast$}{*}}]{data}{}\end{DoxyParamCaption})}

Creates a random set of points distributed in four clusters in 3D space with centroids at the points
\begin{DoxyItemize}
\item $(0,5, 0.5, 0.5)$
\item $(0,5,-0.5, -0.5)$
\item $(-0,5, 0.5, 0.5)$
\item $(-0,5,-0.5, -0.5)$
\end{DoxyItemize}


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ out}}  & {\em data} & matrix to store data in \\
\hline
\end{DoxyParams}

\begin{DoxyCode}{0}
\DoxyCodeLine{00411\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00412\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{data__structures_2sparse__table_8cpp_a10f3ffb3f6f7e1b83d556b9c8de89a5d}{N}}\ =\ \mbox{\hyperlink{hash__search_8cpp_a6e1a77282bc65ad359d753d25df23243}{data}}-\/>size();}
\DoxyCodeLine{00413\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ R\ =\ 0.3;\ \ \textcolor{comment}{//\ radius\ of\ cluster}}
\DoxyCodeLine{00414\ \ \ \ \ \textcolor{keywordtype}{int}\ i\ =\ 0;}
\DoxyCodeLine{00415\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ num\_classes\ =\ 4;}
\DoxyCodeLine{00416\ \ \ \ \ \textcolor{keyword}{const}\ std::array<std::array<double,\ 3>,\ num\_classes>\ centres\ =\ \{}
\DoxyCodeLine{00417\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ centres\ of\ each\ class\ cluster}}
\DoxyCodeLine{00418\ \ \ \ \ \ \ \ \ std::array<double,\ 3>(\{.5,\ .5,\ .5\}),\ \ \ \ \textcolor{comment}{//\ centre\ of\ class\ 1}}
\DoxyCodeLine{00419\ \ \ \ \ \ \ \ \ std::array<double,\ 3>(\{.5,\ -\/.5,\ -\/.5\}),\ \ \textcolor{comment}{//\ centre\ of\ class\ 2}}
\DoxyCodeLine{00420\ \ \ \ \ \ \ \ \ std::array<double,\ 3>(\{-\/.5,\ .5,\ .5\}),\ \ \ \textcolor{comment}{//\ centre\ of\ class\ 3}}
\DoxyCodeLine{00421\ \ \ \ \ \ \ \ \ std::array<double,\ 3>(\{-\/.5,\ -\/.5\ -\/\ .5\})\ \ \textcolor{comment}{//\ centre\ of\ class\ 4}}
\DoxyCodeLine{00422\ \ \ \ \ \};}
\DoxyCodeLine{00423\ }
\DoxyCodeLine{00424\ \textcolor{preprocessor}{\#ifdef\ \_OPENMP}}
\DoxyCodeLine{00425\ \textcolor{preprocessor}{\#pragma\ omp\ for}}
\DoxyCodeLine{00426\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00427\ \ \ \ \ \textcolor{keywordflow}{for}\ (i\ =\ 0;\ i\ <\ \mbox{\hyperlink{data__structures_2sparse__table_8cpp_a10f3ffb3f6f7e1b83d556b9c8de89a5d}{N}};\ i++)\ \{}
\DoxyCodeLine{00428\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ select\ a\ random\ class\ for\ the\ point}}
\DoxyCodeLine{00429\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ cls\ =\ std::rand()\ \%\ num\_classes;}
\DoxyCodeLine{00430\ }
\DoxyCodeLine{00431\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ create\ random\ coordinates\ (x,y,z)\ around\ the\ centre\ of\ the\ class}}
\DoxyCodeLine{00432\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{hash__search_8cpp_a6e1a77282bc65ad359d753d25df23243}{data}}[0][i][0]\ =\ \mbox{\hyperlink{group__machine__learning_gaf5ce14f026d6d231bef29161bac2b485}{\_random}}(centres[cls][0]\ -\/\ R,\ centres[cls][0]\ +\ R);}
\DoxyCodeLine{00433\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{hash__search_8cpp_a6e1a77282bc65ad359d753d25df23243}{data}}[0][i][1]\ =\ \mbox{\hyperlink{group__machine__learning_gaf5ce14f026d6d231bef29161bac2b485}{\_random}}(centres[cls][1]\ -\/\ R,\ centres[cls][1]\ +\ R);}
\DoxyCodeLine{00434\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{hash__search_8cpp_a6e1a77282bc65ad359d753d25df23243}{data}}[0][i][2]\ =\ \mbox{\hyperlink{group__machine__learning_gaf5ce14f026d6d231bef29161bac2b485}{\_random}}(centres[cls][2]\ -\/\ R,\ centres[cls][2]\ +\ R);}
\DoxyCodeLine{00435\ }
\DoxyCodeLine{00436\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ The\ follosing\ can\ also\ be\ used}}
\DoxyCodeLine{00437\ \textcolor{comment}{\ \ \ \ \ \ \ \ for\ (int\ j\ =\ 0;\ j\ <\ 3;\ j++)}}
\DoxyCodeLine{00438\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ data[i][j]\ =\ \_random(centres[class][j]\ -\/\ R,\ centres[class][j]\ +\ R);}}
\DoxyCodeLine{00439\ \textcolor{comment}{\ \ \ \ \ \ \ \ */}}
\DoxyCodeLine{00440\ \ \ \ \ \}}
\DoxyCodeLine{00441\ \}}

\end{DoxyCode}
\Hypertarget{kohonen__som__topology_8cpp_a4b7ab643f6a5002f991837de46f70653}\index{kohonen\_som\_topology.cpp@{kohonen\_som\_topology.cpp}!test\_3d\_classes2@{test\_3d\_classes2}}
\index{test\_3d\_classes2@{test\_3d\_classes2}!kohonen\_som\_topology.cpp@{kohonen\_som\_topology.cpp}}
\doxysubsubsection{\texorpdfstring{test\_3d\_classes2()}{test\_3d\_classes2()}}
{\footnotesize\ttfamily \label{kohonen__som__topology_8cpp_a4b7ab643f6a5002f991837de46f70653} 
void test\+\_\+3d\+\_\+classes2 (\begin{DoxyParamCaption}\item[{std\+::vector$<$ std\+::valarray$<$ double $>$ $>$ \texorpdfstring{$\ast$}{*}}]{data}{}\end{DoxyParamCaption})}

Creates a random set of points distributed in four clusters in 3D space with centroids at the points
\begin{DoxyItemize}
\item $(0,5, 0.5, 0.5)$
\item $(0,5,-0.5, -0.5)$
\item $(-0,5, 0.5, 0.5)$
\item $(-0,5,-0.5, -0.5)$
\end{DoxyItemize}


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ out}}  & {\em data} & matrix to store data in \\
\hline
\end{DoxyParams}

\begin{DoxyCode}{0}
\DoxyCodeLine{00493\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00494\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{data__structures_2sparse__table_8cpp_a10f3ffb3f6f7e1b83d556b9c8de89a5d}{N}}\ =\ \mbox{\hyperlink{hash__search_8cpp_a6e1a77282bc65ad359d753d25df23243}{data}}-\/>size();}
\DoxyCodeLine{00495\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ R\ =\ 0.2;\ \ \textcolor{comment}{//\ radius\ of\ cluster}}
\DoxyCodeLine{00496\ \ \ \ \ \textcolor{keywordtype}{int}\ i\ =\ 0;}
\DoxyCodeLine{00497\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ num\_classes\ =\ 8;}
\DoxyCodeLine{00498\ \ \ \ \ \textcolor{keyword}{const}\ std::array<std::array<double,\ 3>,\ num\_classes>\ centres\ =\ \{}
\DoxyCodeLine{00499\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ centres\ of\ each\ class\ cluster}}
\DoxyCodeLine{00500\ \ \ \ \ \ \ \ \ std::array<double,\ 3>(\{.5,\ .5,\ .5\}),\ \ \ \ \textcolor{comment}{//\ centre\ of\ class\ 1}}
\DoxyCodeLine{00501\ \ \ \ \ \ \ \ \ std::array<double,\ 3>(\{.5,\ .5,\ -\/.5\}),\ \ \ \textcolor{comment}{//\ centre\ of\ class\ 2}}
\DoxyCodeLine{00502\ \ \ \ \ \ \ \ \ std::array<double,\ 3>(\{.5,\ -\/.5,\ .5\}),\ \ \ \textcolor{comment}{//\ centre\ of\ class\ 3}}
\DoxyCodeLine{00503\ \ \ \ \ \ \ \ \ std::array<double,\ 3>(\{.5,\ -\/.5,\ -\/.5\}),\ \ \textcolor{comment}{//\ centre\ of\ class\ 4}}
\DoxyCodeLine{00504\ \ \ \ \ \ \ \ \ std::array<double,\ 3>(\{-\/.5,\ .5,\ .5\}),\ \ \ \textcolor{comment}{//\ centre\ of\ class\ 5}}
\DoxyCodeLine{00505\ \ \ \ \ \ \ \ \ std::array<double,\ 3>(\{-\/.5,\ .5,\ -\/.5\}),\ \ \textcolor{comment}{//\ centre\ of\ class\ 6}}
\DoxyCodeLine{00506\ \ \ \ \ \ \ \ \ std::array<double,\ 3>(\{-\/.5,\ -\/.5,\ .5\}),\ \ \textcolor{comment}{//\ centre\ of\ class\ 7}}
\DoxyCodeLine{00507\ \ \ \ \ \ \ \ \ std::array<double,\ 3>(\{-\/.5,\ -\/.5,\ -\/.5\})\ \ \textcolor{comment}{//\ centre\ of\ class\ 8}}
\DoxyCodeLine{00508\ \ \ \ \ \};}
\DoxyCodeLine{00509\ }
\DoxyCodeLine{00510\ \textcolor{preprocessor}{\#ifdef\ \_OPENMP}}
\DoxyCodeLine{00511\ \textcolor{preprocessor}{\#pragma\ omp\ for}}
\DoxyCodeLine{00512\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00513\ \ \ \ \ \textcolor{keywordflow}{for}\ (i\ =\ 0;\ i\ <\ \mbox{\hyperlink{data__structures_2sparse__table_8cpp_a10f3ffb3f6f7e1b83d556b9c8de89a5d}{N}};\ i++)\ \{}
\DoxyCodeLine{00514\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ select\ a\ random\ class\ for\ the\ point}}
\DoxyCodeLine{00515\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ cls\ =\ std::rand()\ \%\ num\_classes;}
\DoxyCodeLine{00516\ }
\DoxyCodeLine{00517\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ create\ random\ coordinates\ (x,y,z)\ around\ the\ centre\ of\ the\ class}}
\DoxyCodeLine{00518\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{hash__search_8cpp_a6e1a77282bc65ad359d753d25df23243}{data}}[0][i][0]\ =\ \mbox{\hyperlink{group__machine__learning_gaf5ce14f026d6d231bef29161bac2b485}{\_random}}(centres[cls][0]\ -\/\ R,\ centres[cls][0]\ +\ R);}
\DoxyCodeLine{00519\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{hash__search_8cpp_a6e1a77282bc65ad359d753d25df23243}{data}}[0][i][1]\ =\ \mbox{\hyperlink{group__machine__learning_gaf5ce14f026d6d231bef29161bac2b485}{\_random}}(centres[cls][1]\ -\/\ R,\ centres[cls][1]\ +\ R);}
\DoxyCodeLine{00520\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{hash__search_8cpp_a6e1a77282bc65ad359d753d25df23243}{data}}[0][i][2]\ =\ \mbox{\hyperlink{group__machine__learning_gaf5ce14f026d6d231bef29161bac2b485}{\_random}}(centres[cls][2]\ -\/\ R,\ centres[cls][2]\ +\ R);}
\DoxyCodeLine{00521\ }
\DoxyCodeLine{00522\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ The\ follosing\ can\ also\ be\ used}}
\DoxyCodeLine{00523\ \textcolor{comment}{\ \ \ \ \ \ \ \ for\ (int\ j\ =\ 0;\ j\ <\ 3;\ j++)}}
\DoxyCodeLine{00524\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ data[i][j]\ =\ \_random(centres[class][j]\ -\/\ R,\ centres[class][j]\ +\ R);}}
\DoxyCodeLine{00525\ \textcolor{comment}{\ \ \ \ \ \ \ \ */}}
\DoxyCodeLine{00526\ \ \ \ \ \}}
\DoxyCodeLine{00527\ \}}

\end{DoxyCode}
