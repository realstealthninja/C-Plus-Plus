\doxysection{math/ncr\+\_\+modulo\+\_\+p.cpp File Reference}
\hypertarget{ncr__modulo__p_8cpp}{}\label{ncr__modulo__p_8cpp}\index{math/ncr\_modulo\_p.cpp@{math/ncr\_modulo\_p.cpp}}


This program aims at calculating \href{https://cp-algorithms.com/combinatorics/binomial-coefficients.html}{\texttt{ n\+Cr modulo p}}.  


{\ttfamily \#include $<$cassert$>$}\newline
{\ttfamily \#include $<$iostream$>$}\newline
{\ttfamily \#include $<$vector$>$}\newline
\doxysubsubsection*{Classes}
\begin{DoxyCompactItemize}
\item 
class \mbox{\hyperlink{classmath_1_1ncr__modulo__p_1_1_n_c_r_modulo_p}{math\+::ncr\+\_\+modulo\+\_\+p\+::\+NCRModuloP}}
\begin{DoxyCompactList}\small\item\em Class which contains all methods required for calculating n\+Cr mod p. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsubsection*{Namespaces}
\begin{DoxyCompactItemize}
\item 
namespace \mbox{\hyperlink{namespacemath}{math}}
\begin{DoxyCompactList}\small\item\em for IO operations \end{DoxyCompactList}\item 
namespace \mbox{\hyperlink{namespacencr__modulo__p}{ncr\+\_\+modulo\+\_\+p}}
\begin{DoxyCompactList}\small\item\em Functions for \href{https://cp-algorithms.com/combinatorics/binomial-coefficients.html}{\texttt{ n\+Cr modulo p}} implementation. \end{DoxyCompactList}\item 
namespace \mbox{\hyperlink{namespaceutils}{utils}}
\begin{DoxyCompactList}\small\item\em this namespace contains the definitions of the functions called from the class \doxylink{classmath_1_1ncr__modulo__p_1_1_n_c_r_modulo_p}{math\+::ncr\+\_\+modulo\+\_\+p\+::\+NCRModuloP} \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
int64\+\_\+t \mbox{\hyperlink{ncr__modulo__p_8cpp_a9010ad5669d31449c3bf3271ab5ebc86}{math\+::ncr\+\_\+modulo\+\_\+p\+::utils\+::gcd\+Extended}} (const int64\+\_\+t \&a, const int64\+\_\+t \&b, int64\+\_\+t \&x, int64\+\_\+t \&y)
\begin{DoxyCompactList}\small\item\em finds the values x and y such that a\texorpdfstring{$\ast$}{*}x + b\texorpdfstring{$\ast$}{*}y = gcd(a,b) \end{DoxyCompactList}\item 
int64\+\_\+t \mbox{\hyperlink{ncr__modulo__p_8cpp_a6c7bfe3bdaa086d32261a5c5584d0fa9}{math\+::ncr\+\_\+modulo\+\_\+p\+::utils\+::mod\+Inverse}} (const int64\+\_\+t \&a, const int64\+\_\+t \&m)
\item 
static void \mbox{\hyperlink{ncr__modulo__p_8cpp_a483bb8ccf42aaf7375a83e91490eda1e}{tests}} ()
\begin{DoxyCompactList}\small\item\em tests \doxylink{classmath_1_1ncr__modulo__p_1_1_n_c_r_modulo_p}{math\+::ncr\+\_\+modulo\+\_\+p\+::\+NCRModuloP} \end{DoxyCompactList}\item 
void \mbox{\hyperlink{ncr__modulo__p_8cpp_afa2b50f4716fc3b42221a72e676e1422}{example}} ()
\begin{DoxyCompactList}\small\item\em example showing the usage of the \doxylink{classmath_1_1ncr__modulo__p_1_1_n_c_r_modulo_p}{math\+::ncr\+\_\+modulo\+\_\+p\+::\+NCRModuloP} class \end{DoxyCompactList}\item 
int \mbox{\hyperlink{ncr__modulo__p_8cpp_ae66f6b31b5ad750f1fe042a706a4e3d4}{main}} ()
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
This program aims at calculating \href{https://cp-algorithms.com/combinatorics/binomial-coefficients.html}{\texttt{ n\+Cr modulo p}}. 

n\+Cr is defined as n! / (r! \texorpdfstring{$\ast$}{*} (n-\/r)!) where n! represents factorial of n. In many cases, the value of n\+Cr is too large to fit in a 64 bit integer. Hence, in competitive programming, there are many problems or subproblems to compute n\+Cr modulo p where p is a given number. \begin{DoxyAuthor}{Author}
\href{https://github.com/KaustubhDamania}{\texttt{ Kaustubh Damania}} 
\end{DoxyAuthor}


\doxysubsection{Function Documentation}
\Hypertarget{ncr__modulo__p_8cpp_afa2b50f4716fc3b42221a72e676e1422}\index{ncr\_modulo\_p.cpp@{ncr\_modulo\_p.cpp}!example@{example}}
\index{example@{example}!ncr\_modulo\_p.cpp@{ncr\_modulo\_p.cpp}}
\doxysubsubsection{\texorpdfstring{example()}{example()}}
{\footnotesize\ttfamily \label{ncr__modulo__p_8cpp_afa2b50f4716fc3b42221a72e676e1422} 
void example (\begin{DoxyParamCaption}{}{}\end{DoxyParamCaption})}



example showing the usage of the \doxylink{classmath_1_1ncr__modulo__p_1_1_n_c_r_modulo_p}{math\+::ncr\+\_\+modulo\+\_\+p\+::\+NCRModuloP} class 


\begin{DoxyCode}{0}
\DoxyCodeLine{00175\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00176\ \ \ \ \ \textcolor{keyword}{const}\ int64\_t\ size\ =\ 1e6\ +\ 1;}
\DoxyCodeLine{00177\ \ \ \ \ \textcolor{keyword}{const}\ int64\_t\ p\ =\ 1e9\ +\ 7;}
\DoxyCodeLine{00178\ }
\DoxyCodeLine{00179\ \ \ \ \ \textcolor{comment}{//\ the\ ncrObj\ contains\ the\ precomputed\ values\ of\ factorials\ modulo\ p\ for}}
\DoxyCodeLine{00180\ \ \ \ \ \textcolor{comment}{//\ values\ from\ 0\ to\ size}}
\DoxyCodeLine{00181\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keyword}{auto}\ ncrObj\ =\ \mbox{\hyperlink{classmath_1_1ncr__modulo__p_1_1_n_c_r_modulo_p}{math::ncr\_modulo\_p::NCRModuloP}}(size,\ p);}
\DoxyCodeLine{00182\ }
\DoxyCodeLine{00183\ \ \ \ \ \textcolor{comment}{//\ having\ the\ ncrObj\ we\ can\ efficiently\ query\ the\ values\ of\ (n\ C\ r)\%p}}
\DoxyCodeLine{00184\ \ \ \ \ \textcolor{comment}{//\ note\ that\ time\ of\ the\ computation\ does\ not\ depend\ on\ size}}
\DoxyCodeLine{00185\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <=\ 7;\ i++)\ \{}
\DoxyCodeLine{00186\ \ \ \ \ \ \ \ \ std::cout\ <<\ 6\ <<\ \textcolor{stringliteral}{"{}C"{}}\ <<\ i\ <<\ \textcolor{stringliteral}{"{}\ mod\ "{}}\ <<\ p\ <<\ \textcolor{stringliteral}{"{}\ =\ "{}}\ <<\ ncrObj.ncr(6,\ i)}
\DoxyCodeLine{00187\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{00188\ \ \ \ \ \}}
\DoxyCodeLine{00189\ \}}

\end{DoxyCode}
\Hypertarget{ncr__modulo__p_8cpp_a9010ad5669d31449c3bf3271ab5ebc86}\index{ncr\_modulo\_p.cpp@{ncr\_modulo\_p.cpp}!gcdExtended@{gcdExtended}}
\index{gcdExtended@{gcdExtended}!ncr\_modulo\_p.cpp@{ncr\_modulo\_p.cpp}}
\doxysubsubsection{\texorpdfstring{gcdExtended()}{gcdExtended()}}
{\footnotesize\ttfamily \label{ncr__modulo__p_8cpp_a9010ad5669d31449c3bf3271ab5ebc86} 
int64\+\_\+t math\+::ncr\+\_\+modulo\+\_\+p\+::utils\+::gcd\+Extended (\begin{DoxyParamCaption}\item[{const int64\+\_\+t \&}]{a}{, }\item[{const int64\+\_\+t \&}]{b}{, }\item[{int64\+\_\+t \&}]{x}{, }\item[{int64\+\_\+t \&}]{y}{}\end{DoxyParamCaption})}



finds the values x and y such that a\texorpdfstring{$\ast$}{*}x + b\texorpdfstring{$\ast$}{*}y = gcd(a,b) 


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em a} & the first input of the gcd \\
\hline
\mbox{\texttt{ in}}  & {\em a} & the second input of the gcd \\
\hline
\mbox{\texttt{ out}}  & {\em x} & the Bézout coefficient of a \\
\hline
\mbox{\texttt{ out}}  & {\em y} & the Bézout coefficient of b \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
the gcd of a and b 
\end{DoxyReturn}

\begin{DoxyCode}{0}
\DoxyCodeLine{00045\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00046\ \ \ \ \ \textcolor{keywordflow}{if}\ (a\ ==\ 0)\ \{}
\DoxyCodeLine{00047\ \ \ \ \ \ \ \ \ x\ =\ 0;}
\DoxyCodeLine{00048\ \ \ \ \ \ \ \ \ y\ =\ 1;}
\DoxyCodeLine{00049\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ b;}
\DoxyCodeLine{00050\ \ \ \ \ \}}
\DoxyCodeLine{00051\ }
\DoxyCodeLine{00052\ \ \ \ \ int64\_t\ x1\ =\ 0,\ y1\ =\ 0;}
\DoxyCodeLine{00053\ \ \ \ \ \textcolor{keyword}{const}\ int64\_t\ \mbox{\hyperlink{gcd__iterative__euclidean_8cpp_ae48807fa2b7000afae599e67f327545e}{gcd}}\ =\ \mbox{\hyperlink{ncr__modulo__p_8cpp_a9010ad5669d31449c3bf3271ab5ebc86}{gcdExtended}}(b\ \%\ a,\ a,\ x1,\ y1);}
\DoxyCodeLine{00054\ }
\DoxyCodeLine{00055\ \ \ \ \ x\ =\ y1\ -\/\ (b\ /\ a)\ *\ x1;}
\DoxyCodeLine{00056\ \ \ \ \ y\ =\ x1;}
\DoxyCodeLine{00057\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{gcd__iterative__euclidean_8cpp_ae48807fa2b7000afae599e67f327545e}{gcd}};}
\DoxyCodeLine{00058\ \}}

\end{DoxyCode}
\Hypertarget{ncr__modulo__p_8cpp_ae66f6b31b5ad750f1fe042a706a4e3d4}\index{ncr\_modulo\_p.cpp@{ncr\_modulo\_p.cpp}!main@{main}}
\index{main@{main}!ncr\_modulo\_p.cpp@{ncr\_modulo\_p.cpp}}
\doxysubsubsection{\texorpdfstring{main()}{main()}}
{\footnotesize\ttfamily \label{ncr__modulo__p_8cpp_ae66f6b31b5ad750f1fe042a706a4e3d4} 
int main (\begin{DoxyParamCaption}\item[{void}]{}{}\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00191\ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00192\ \ \ \ \ \mbox{\hyperlink{ncr__modulo__p_8cpp_a483bb8ccf42aaf7375a83e91490eda1e}{tests}}();}
\DoxyCodeLine{00193\ \ \ \ \ \mbox{\hyperlink{ncr__modulo__p_8cpp_afa2b50f4716fc3b42221a72e676e1422}{example}}();}
\DoxyCodeLine{00194\ \ \ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{00195\ \}}

\end{DoxyCode}
\Hypertarget{ncr__modulo__p_8cpp_a6c7bfe3bdaa086d32261a5c5584d0fa9}\index{ncr\_modulo\_p.cpp@{ncr\_modulo\_p.cpp}!modInverse@{modInverse}}
\index{modInverse@{modInverse}!ncr\_modulo\_p.cpp@{ncr\_modulo\_p.cpp}}
\doxysubsubsection{\texorpdfstring{modInverse()}{modInverse()}}
{\footnotesize\ttfamily \label{ncr__modulo__p_8cpp_a6c7bfe3bdaa086d32261a5c5584d0fa9} 
int64\+\_\+t math\+::ncr\+\_\+modulo\+\_\+p\+::utils\+::mod\+Inverse (\begin{DoxyParamCaption}\item[{const int64\+\_\+t \&}]{a}{, }\item[{const int64\+\_\+t \&}]{m}{}\end{DoxyParamCaption})}

Find modular inverse of a modulo m i.\+e. a number x such that (a\texorpdfstring{$\ast$}{*}x)m = 1


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em a} & the number for which the modular inverse is queried \\
\hline
\mbox{\texttt{ in}}  & {\em m} & the modulus \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
the inverce of a modulo m, if it exists, -\/1 otherwise 
\end{DoxyReturn}

\begin{DoxyCode}{0}
\DoxyCodeLine{00066\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00067\ \ \ \ \ int64\_t\ x\ =\ 0,\ y\ =\ 0;}
\DoxyCodeLine{00068\ \ \ \ \ \textcolor{keyword}{const}\ int64\_t\ \mbox{\hyperlink{composite__simpson__rule_8cpp_a2f67508d5f392b0321772169342c98ad}{g}}\ =\ \mbox{\hyperlink{ncr__modulo__p_8cpp_a9010ad5669d31449c3bf3271ab5ebc86}{gcdExtended}}(a,\ m,\ x,\ y);}
\DoxyCodeLine{00069\ \ \ \ \ \textcolor{keywordflow}{if}\ (g\ !=\ 1)\ \{\ \ \textcolor{comment}{//\ modular\ inverse\ doesn't\ exist}}
\DoxyCodeLine{00070\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ -\/1;}
\DoxyCodeLine{00071\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00072\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ ((x\ +\ m)\ \%\ m);}
\DoxyCodeLine{00073\ \ \ \ \ \}}
\DoxyCodeLine{00074\ \}}

\end{DoxyCode}
\Hypertarget{ncr__modulo__p_8cpp_a483bb8ccf42aaf7375a83e91490eda1e}\index{ncr\_modulo\_p.cpp@{ncr\_modulo\_p.cpp}!tests@{tests}}
\index{tests@{tests}!ncr\_modulo\_p.cpp@{ncr\_modulo\_p.cpp}}
\doxysubsubsection{\texorpdfstring{tests()}{tests()}}
{\footnotesize\ttfamily \label{ncr__modulo__p_8cpp_a483bb8ccf42aaf7375a83e91490eda1e} 
static void tests (\begin{DoxyParamCaption}{}{}\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}



tests \doxylink{classmath_1_1ncr__modulo__p_1_1_n_c_r_modulo_p}{math\+::ncr\+\_\+modulo\+\_\+p\+::\+NCRModuloP} 


\begin{DoxyCode}{0}
\DoxyCodeLine{00142\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00143\ \ \ \ \ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_test_case}{TestCase}}\ \{}
\DoxyCodeLine{00144\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ int64\_t\ size;}
\DoxyCodeLine{00145\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ int64\_t\ p;}
\DoxyCodeLine{00146\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ int64\_t\ n;}
\DoxyCodeLine{00147\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ int64\_t\ r;}
\DoxyCodeLine{00148\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ int64\_t\ expected;}
\DoxyCodeLine{00149\ }
\DoxyCodeLine{00150\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{struct_test_case}{TestCase}}(\textcolor{keyword}{const}\ int64\_t\ size,\ \textcolor{keyword}{const}\ int64\_t\ p,\ \textcolor{keyword}{const}\ int64\_t\ n,}
\DoxyCodeLine{00151\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ int64\_t\ r,\ \textcolor{keyword}{const}\ int64\_t\ expected)}
\DoxyCodeLine{00152\ \ \ \ \ \ \ \ \ \ \ \ \ :\ size(size),\ p(p),\ n(n),\ r(r),\ expected(expected)\ \{\}}
\DoxyCodeLine{00153\ \ \ \ \ \};}
\DoxyCodeLine{00154\ \ \ \ \ \textcolor{keyword}{const}\ std::vector<TestCase>\ test\_cases\ =\ \{}
\DoxyCodeLine{00155\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{struct_test_case}{TestCase}}(60000,\ 1000000007,\ 52323,\ 26161,\ 224944353),}
\DoxyCodeLine{00156\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{struct_test_case}{TestCase}}(20,\ 5,\ 6,\ 2,\ 30\ \%\ 5),}
\DoxyCodeLine{00157\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{struct_test_case}{TestCase}}(100,\ 29,\ 7,\ 3,\ 35\ \%\ 29),}
\DoxyCodeLine{00158\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{struct_test_case}{TestCase}}(1000,\ 13,\ 10,\ 3,\ 120\ \%\ 13),}
\DoxyCodeLine{00159\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{struct_test_case}{TestCase}}(20,\ 17,\ 1,\ 10,\ 0),}
\DoxyCodeLine{00160\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{struct_test_case}{TestCase}}(45,\ 19,\ 23,\ 1,\ 23\ \%\ 19),}
\DoxyCodeLine{00161\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{struct_test_case}{TestCase}}(45,\ 19,\ 23,\ 0,\ 1),}
\DoxyCodeLine{00162\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{struct_test_case}{TestCase}}(45,\ 19,\ 23,\ 23,\ 1),}
\DoxyCodeLine{00163\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{struct_test_case}{TestCase}}(20,\ 9,\ 10,\ 2,\ -\/1)\};}
\DoxyCodeLine{00164\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{const}\ \textcolor{keyword}{auto}\&\ tc\ :\ test\_cases)\ \{}
\DoxyCodeLine{00165\ \ \ \ \ \ \ \ \ assert(\mbox{\hyperlink{classmath_1_1ncr__modulo__p_1_1_n_c_r_modulo_p}{math::ncr\_modulo\_p::NCRModuloP}}(tc.size,\ tc.p).\mbox{\hyperlink{classmath_1_1ncr__modulo__p_1_1_n_c_r_modulo_p_a499df7a01bcd348345dc5a0ab79bb0e9}{ncr}}(tc.n,\ tc.r)\ ==}
\DoxyCodeLine{00166\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tc.expected);}
\DoxyCodeLine{00167\ \ \ \ \ \}}
\DoxyCodeLine{00168\ }
\DoxyCodeLine{00169\ \ \ \ \ std::cout\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n\(\backslash\)nAll\ tests\ have\ successfully\ passed!\(\backslash\)n"{}};}
\DoxyCodeLine{00170\ \}}

\end{DoxyCode}
