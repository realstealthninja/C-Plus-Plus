\doxysection{graph/lowest\+\_\+common\+\_\+ancestor.cpp File Reference}
\hypertarget{lowest__common__ancestor_8cpp}{}\label{lowest__common__ancestor_8cpp}\index{graph/lowest\_common\_ancestor.cpp@{graph/lowest\_common\_ancestor.cpp}}


Data structure for finding the lowest common ancestor of two vertices in a rooted tree using binary lifting.  


{\ttfamily \#include $<$cassert$>$}\newline
{\ttfamily \#include $<$iostream$>$}\newline
{\ttfamily \#include $<$queue$>$}\newline
{\ttfamily \#include $<$utility$>$}\newline
{\ttfamily \#include $<$vector$>$}\newline
\doxysubsubsection*{Classes}
\begin{DoxyCompactItemize}
\item 
class \mbox{\hyperlink{classgraph_1_1_graph}{graph\+::\+Graph$<$ T $>$}}
\item 
class \mbox{\hyperlink{classgraph_1_1_rooted_tree}{graph\+::\+Rooted\+Tree}}
\item 
class \mbox{\hyperlink{classgraph_1_1_lowest_common_ancestor}{graph\+::\+Lowest\+Common\+Ancestor}}
\end{DoxyCompactItemize}
\doxysubsubsection*{Namespaces}
\begin{DoxyCompactItemize}
\item 
namespace \mbox{\hyperlink{namespacegraph}{graph}}
\begin{DoxyCompactList}\small\item\em \doxylink{classgraph_1_1_graph}{Graph} Algorithms. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
static void \mbox{\hyperlink{lowest__common__ancestor_8cpp_a483bb8ccf42aaf7375a83e91490eda1e}{tests}} ()
\item 
int \mbox{\hyperlink{lowest__common__ancestor_8cpp_ae66f6b31b5ad750f1fe042a706a4e3d4}{main}} ()
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
Data structure for finding the lowest common ancestor of two vertices in a rooted tree using binary lifting. 

Algorithm\+: \href{https://cp-algorithms.com/graph/lca_binary_lifting.html}{\texttt{ https\+://cp-\/algorithms.\+com/graph/lca\+\_\+binary\+\_\+lifting.\+html}}

Complexity\+:
\begin{DoxyItemize}
\item Precomputation\+: $O(N \log N)$ where $N$ is the number of vertices in the tree
\item Query\+: $O(\log N)$
\item Space\+: $O(N \log N)$
\end{DoxyItemize}

Example\+: ~\newline
 Tree\+: 
\begin{DoxyPre}
            \_  3  \_
         /     |     \textbackslash{}
       1       6       4
     / |     /   \textbackslash{}       \textbackslash{}
   7   5   2       8       0
           |
           9
\end{DoxyPre}


~\newline
 lowest\+\_\+common\+\_\+ancestor(7, 4) = 3 ~\newline
 lowest\+\_\+common\+\_\+ancestor(9, 6) = 6 ~\newline
 lowest\+\_\+common\+\_\+ancestor(0, 0) = 0 ~\newline
 lowest\+\_\+common\+\_\+ancestor(8, 2) = 6

The query is symmetrical, therefore lowest\+\_\+common\+\_\+ancestor(x, y) = lowest\+\_\+common\+\_\+ancestor(y, x) 

\doxysubsection{Function Documentation}
\Hypertarget{lowest__common__ancestor_8cpp_ae66f6b31b5ad750f1fe042a706a4e3d4}\index{lowest\_common\_ancestor.cpp@{lowest\_common\_ancestor.cpp}!main@{main}}
\index{main@{main}!lowest\_common\_ancestor.cpp@{lowest\_common\_ancestor.cpp}}
\doxysubsubsection{\texorpdfstring{main()}{main()}}
{\footnotesize\ttfamily \label{lowest__common__ancestor_8cpp_ae66f6b31b5ad750f1fe042a706a4e3d4} 
int main (\begin{DoxyParamCaption}\item[{void}]{}{}\end{DoxyParamCaption})}

Main function 
\begin{DoxyCode}{0}
\DoxyCodeLine{00255\ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00256\ \ \ \ \ \mbox{\hyperlink{lowest__common__ancestor_8cpp_a483bb8ccf42aaf7375a83e91490eda1e}{tests}}();}
\DoxyCodeLine{00257\ \ \ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{00258\ \}}

\end{DoxyCode}
\Hypertarget{lowest__common__ancestor_8cpp_a483bb8ccf42aaf7375a83e91490eda1e}\index{lowest\_common\_ancestor.cpp@{lowest\_common\_ancestor.cpp}!tests@{tests}}
\index{tests@{tests}!lowest\_common\_ancestor.cpp@{lowest\_common\_ancestor.cpp}}
\doxysubsubsection{\texorpdfstring{tests()}{tests()}}
{\footnotesize\ttfamily \label{lowest__common__ancestor_8cpp_a483bb8ccf42aaf7375a83e91490eda1e} 
static void tests (\begin{DoxyParamCaption}{}{}\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}

Unit tests \begin{DoxyReturn}{Returns}
none 
\end{DoxyReturn}
\begin{DoxyVerb}     _  3  _
  /     |     \
1       6       4
\end{DoxyVerb}
 / \texorpdfstring{$\vert$}{|} / \textbackslash{} \textbackslash{} 7 5 2 8 0 \texorpdfstring{$\vert$}{|} 9
\begin{DoxyCode}{0}
\DoxyCodeLine{00234\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{\textcolor{comment}{}}
\DoxyCodeLine{00235\ \textcolor{comment}{\ \ \ \ /**}}
\DoxyCodeLine{00236\ \textcolor{comment}{\ \ \ \ \ *\ \ \ \ \ \ \ \ \ \ \ \ \ \_\ \ 3\ \ \_}}
\DoxyCodeLine{00237\ \textcolor{comment}{\ \ \ \ \ *\ \ \ \ \ \ \ \ \ \ /\ \ \ \ \ |\ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00238\ \textcolor{comment}{\ \ \ \ \ *\ \ \ \ \ \ \ \ 1\ \ \ \ \ \ \ 6\ \ \ \ \ \ \ 4}}
\DoxyCodeLine{00239\ \textcolor{comment}{\ \ \ \ \ *\ \ \ \ \ \ /\ |\ \ \ \ \ /\ \ \ \(\backslash\)\ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00240\ \textcolor{comment}{\ \ \ \ \ *\ \ \ \ 7\ \ \ 5\ \ \ 2\ \ \ \ \ \ \ 8\ \ \ \ \ \ \ 0}}
\DoxyCodeLine{00241\ \textcolor{comment}{\ \ \ \ \ *\ \ \ \ \ \ \ \ \ \ \ \ |}}
\DoxyCodeLine{00242\ \textcolor{comment}{\ \ \ \ \ *\ \ \ \ \ \ \ \ \ \ \ \ 9}}
\DoxyCodeLine{00243\ \textcolor{comment}{\ \ \ \ \ */}}
\DoxyCodeLine{00244\ \ \ \ \ std::vector<std::pair<int,\ int>\ >\ edges\ =\ \{}
\DoxyCodeLine{00245\ \ \ \ \ \ \ \ \ \{7,\ 1\},\ \{1,\ 5\},\ \{1,\ 3\},\ \{3,\ 6\},\ \{6,\ 2\},\ \{2,\ 9\},\ \{6,\ 8\},\ \{4,\ 3\},\ \{0,\ 4\}\};}
\DoxyCodeLine{00246\ \ \ \ \ \mbox{\hyperlink{classgraph_1_1_rooted_tree}{graph::RootedTree}}\ t(edges,\ 3);}
\DoxyCodeLine{00247\ \ \ \ \ \mbox{\hyperlink{classgraph_1_1_lowest_common_ancestor}{graph::LowestCommonAncestor}}\ lca(t);}
\DoxyCodeLine{00248\ \ \ \ \ assert(lca.lowest\_common\_ancestor(7,\ 4)\ ==\ 3);}
\DoxyCodeLine{00249\ \ \ \ \ assert(lca.lowest\_common\_ancestor(9,\ 6)\ ==\ 6);}
\DoxyCodeLine{00250\ \ \ \ \ assert(lca.lowest\_common\_ancestor(0,\ 0)\ ==\ 0);}
\DoxyCodeLine{00251\ \ \ \ \ assert(lca.lowest\_common\_ancestor(8,\ 2)\ ==\ 6);}
\DoxyCodeLine{00252\ \}}

\end{DoxyCode}
